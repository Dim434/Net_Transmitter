<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>PEAR2_Net_Transmitter documentation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" href="../css/template.css" type="text/css"></link><script type="text/javascript" src="../js/jquery-1.4.2.min.js"></script><script type="text/javascript" src="../js/jquery.tools.min.js"></script><script type="text/javascript" src="../js/jquery-ui-1.8.2.custom.min.js"></script><script type="text/javascript" src="../js/template.js"></script></head><body><div id="content"><h1 class="file">TcpClient.php<a href="../source/TcpClient.php.html"><img src="../images/icons/view_source.png" alt="View Source" border="0"></img></a></h1><div id="file-nav-box"><div id="file-nav-options">
              Show:
              <img src="../images/icons/visibility_public.png" alt="Public" id="show-public"></img><img src="../images/icons/visibility_protected.png" alt="Protected" id="show-protected"></img><img src="../images/icons/visibility_private.png" alt="Private" id="show-private"></img><span class="attribute" id="show-inherited">inherited</span></div><div id="file-nav-container"><ul id="file-nav"><li><a href="#classes"><img src="../images/icons/class.png" alt="Class" height="14"></img>
                          Classes
                      </a><ul><li><a href="#\PEAR2\Net\Transmitter\TcpClient">\PEAR2\Net\Transmitter\TcpClient</a></li></ul></li></ul><div style="clear: left;"></div></div><div id="file-nav-tab">
              Table of Contents
          </div></div><a name="top" class="anchor"></a><div id="file-description"><div class="short-description">Wrapper for network stream functionality.</div><div class="long-description">PHP has built in support for various types of network streams, such as HTTP and TCP sockets. One problem that arises with them is the fact that a single fread/fwrite call might not read/write all the data you intended, regardless of whether you're in blocking mode or not. While the PHP manual offers a workaround in the form of a loop with a few variables, using it every single time you want to read/write can be tedious.

This package abstracts this away, so that when you want to get exactly N amount of bytes, you can be sure the upper levels of your app will be dealing with N bytes. Oh, and the functionality is nicely wrapped in an object (but that's just the icing on the cake).

PHP version 5</div></div><dl class="file-info"><dt>Author</dt><dd><a href="mailto:boen.robot@gmail.com">Vasil Rangelov</a>
         
    </dd><dt>Category</dt><dd>Net
         
    </dd><dt>Copyright</dt><dd>2011 Vasil Rangelov
         
    </dd><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/lesser.html">LGPL License 2.1</a>
         
    </dd><dt>Link</dt><dd><a href="http://pear2.php.net/PEAR2_Net_Transmitter">http://pear2.php.net/PEAR2_Net_Transmitter</a>
         
    </dd><dt>Package</dt><dd>PEAR2_Net_Transmitter
         
    </dd><dt>Version</dt><dd>1.0.0a4
         
    </dd></dl><a name="classes" class="anchor"></a><a id="\PEAR2\Net\Transmitter\TcpClient" class="anchor"></a><h2 class="class">\PEAR2\Net\Transmitter\TcpClient<div class="to-top"><a href="#top">jump to top</a></div></h2><div class="class"><small class="package"><b>Package: </b>PEAR2_Net_Transmitter</small><div class="short-description">A socket transmitter.</div><div class="long-description">This is a convinience wrapper for socket functionality. Used to ensure data
integrity.</div><dl class="class-info"><dt>Parent(s)</dt><dd><a href="../files/NetworkStream.html#\PEAR2\Net\Transmitter\NetworkStream">\PEAR2\Net\Transmitter\NetworkStream</a>
            &lt;
            <a href="../files/Stream.html#\PEAR2\Net\Transmitter\Stream" style="color: gray; font-size: 0.8em
                ">\PEAR2\Net\Transmitter\Stream</a></dd><dt>Author</dt><dd><a href="mailto:boen.robot@gmail.com">Vasil Rangelov</a>
         
    </dd><dt>Category</dt><dd>Net
         
    </dd><dt>License</dt><dd><a href="http://www.gnu.org/copyleft/lesser.html">LGPL License 2.1</a>
         
    </dd><dt>Link</dt><dd><a href="http://pear2.php.net/PEAR2_Net_Transmitter">http://pear2.php.net/PEAR2_Net_Transmitter</a>
         
    </dd></dl><h3>Properties</h3><div><a id="\PEAR2\Net\Transmitter\TcpClient::$cryptoScheme" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">$cryptoScheme</span> = array(parent::CRYPTO_OFF =&gt; 'tcp', parent::CRYPTO_SSL2 =&gt; 'sslv2', parent::CRYPTO_SSL3 =&gt; 'sslv3', parent::CRYPTO_SSL =&gt; 'ssl', parent::CRYPTO_TLS =&gt; 'tls')</code><div class="description"><span class="attribute">static</span></div><div class="code-tabs"><div class="long-description"></div><strong>Default value</strong><code>array(parent::CRYPTO_OFF =&gt; 'tcp', parent::CRYPTO_SSL2 =&gt; 'sslv2', parent::CRYPTO_SSL3 =&gt; 'sslv3', parent::CRYPTO_SSL =&gt; 'ssl', parent::CRYPTO_TLS =&gt; 'tls')</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>n/a</dd></dl></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::$error_no" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>int <span class="highlight">$error_no</span> = 0</code><div class="description"><div class="short-description"><p>The error code of the last error on the socket.</p></div></div><div class="code-tabs"><div class="long-description"></div><strong>Default value</strong><code>0</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>int</dd></dl></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::$error_str" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>string <span class="highlight">$error_str</span> = null</code><div class="description"><div class="short-description"><p>The error message of the last error on the socket.</p></div></div><div class="code-tabs"><div class="long-description"></div><strong>Default value</strong><code>null</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>string</dd></dl></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::$lockState" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>array <span class="highlight">$lockState</span> = array()</code><div class="description"><span class="attribute">static</span><div class="short-description"><p>An array with all connections from this PHP request (as keys)
    and their lock state (as a value).</p>
</div></div><div class="code-tabs"><div class="long-description"></div><strong>Default value</strong><code>array()</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>array</dd></dl></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::$shmHandler" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>\PEAR2\Cache\SHM <span class="highlight">$shmHandler</span> = null</code><div class="description"><div class="short-description"><p>Persistent connection handler. Remains NULL for non-persistent
    connections.</p>
</div></div><div class="code-tabs"><div class="long-description"></div><strong>Default value</strong><code>null</code><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd><a href="../files/SHM.html">\PEAR2\Cache\SHM</a></dd></dl></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::$uri" class="anchor"></a><div class="property protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png" alt="&gt;"></img><img src="../images/icons/arrow_down.png" alt="V" style="display: none;"></img></a><code class="title"><img src="../images/icons/property.png" alt="Property"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img>string <span class="highlight">$uri</span></code><div class="description"><div class="short-description"><p>The URI of this connection.</p></div></div><div class="code-tabs"><div class="long-description"></div><strong>Details</strong><dl class="property-info"><dt>Type</dt><dd>string</dd></dl></div><div class="clear"></div></div></div><h3>Methods</h3><div><a id="\PEAR2\Net\Transmitter\TcpClient::__construct()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">__construct</span><span class="nb-faded-text">(string $host, int $port, bool $persist = false, float $timeout = null, string $key = '', string $crypto = parent::CRYPTO_OFF, resource $context = null)</span> : void</code><div class="description"><p class="short_description">Creates a new connection with the specified options.</p></div><div class="code-tabs"><div class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$host</th><td>string</td><td><em><p>Hostname (IP or domain) of the server.</p>
</em></td></tr><tr><th>$port</th><td>int</td><td><em><p>The port on the server.</p></em></td></tr><tr><th>$persist</th><td>bool</td><td><em><p>Whether or not the connection should be a
    persistent one.</p></em></td></tr><tr><th>$timeout</th><td>float</td><td><em><p>The timeout for the connection.</p></em></td></tr><tr><th>$key</th><td>string</td><td><em><p>A string that uniquely identifies the
    connection.</p></em></td></tr><tr><th>$crypto</th><td>string</td><td><em><p>Encryption setting. Must be one of the
    NetworkStream::CRYPTO_* constants. By default, encryption is
    disabled. If the setting has an associated scheme for it, it will be
    used, and if not, the setting will be adjusted right after the
    connection is estabilished.</p>
</em></td></tr><tr><th>$context</th><td>resource</td><td><em><p>A context for the socket.</p></em></td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::_handleError()" class="anchor"></a><div class="method private"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_private.png" style="margin-right: 5px" alt="private"></img><span class="highlight">_handleError</span><span class="nb-faded-text">( $level,  $message)</span> : void</code><div class="description"><span class="attribute">static</span><p class="short_description"></p></div><div class="code-tabs"><div class="long-description"></div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$level</th><td></td><td><em></em></td></tr><tr><th>$message</th><td></td><td><em></em></td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::createException()" class="anchor"></a><div class="method protected"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_protected.png" style="margin-right: 5px" alt="protected"></img><span class="highlight">createException</span><span class="nb-faded-text">(string $message, int $code = 0, <a href="../files/Exception.html">\Exception</a> $previous = null)</span> : <a href="../files/SocketException.html">\PEAR2\Net\Transmitter\SocketException</a></code><div class="description"><p class="short_description">Creates a new exception.</p></div><div class="code-tabs"><div class="long-description">Creates a new exception. Used by the rest of the functions in this class.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$message</th><td>string</td><td><em><p>The exception message.</p></em></td></tr><tr><th>$code</th><td>int</td><td><em><p>The exception code.</p></em></td></tr><tr><th>$previous</th><td><a href="../files/Exception.html">\Exception</a></td><td><em><p>Previous exception thrown.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td><a href="../files/SocketException.html">\PEAR2\Net\Transmitter\SocketException</a></td><td>The exception to then be thrown.</td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::lock()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">lock</span><span class="nb-faded-text">(int $direction = self::DIRECTION_ALL, bool $replace = false)</span> : int</code><div class="description"><p class="short_description">Locks transmission.</p></div><div class="code-tabs"><div class="long-description">Locks transmission in one or more directions. Useful when dealing with
persistent connections. Note that every send/receive call implicitly
calls this function and then restores it to the previous state. You only
need to call this function if you need to do an uninterrputed sequence of
such calls.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$direction</th><td>int</td><td><em><p>The direction(s) to have locked. Acceptable values
    are the DIRECTION_* constants. If a lock for a direction can't be
    obtained immediatly, the function will block until one is aquired.
    Note that if you specify {@link DIRECTION_ALL}, the sending lock will
    be obtained before the receiving one, and if obtaining the receiving
    lock afterwards fails, the sending lock will be released too.</p>
</em></td></tr><tr><th>$replace</th><td>bool</td><td><em><p>Whether to replace all locks with the specified
    ones. Setting this to FALSE will make the function only obtain the
    locks which are not already obtained.</p></em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>int</td><td>The previous state or FALSE if the connection is not
    persistent or arguments are invalid.</td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::receive()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">receive</span><span class="nb-faded-text">(int $length, string $what = 'data')</span> : string</code><div class="description"><p class="short_description">Receives data from the server.</p></div><div class="code-tabs"><div class="long-description">Receives data from the server as a string.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$length</th><td>int</td><td><em><p>The number of bytes to receive.</p></em></td></tr><tr><th>$what</th><td>string</td><td><em><p>Descriptive string about what is being received
    (used in exception messages).</p>
</em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>string</td><td>The received content.</td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::receiveStream()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">receiveStream</span><span class="nb-faded-text">(int $length, <a href="../files/FilterCollection.html">\PEAR2\Net\Transmitter\FilterCollection</a> $filters = null, string $what = 'stream data')</span> : resource</code><div class="description"><p class="short_description">Receives data from the server.</p></div><div class="code-tabs"><div class="long-description">Receives data from the server as a stream.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$length</th><td>int</td><td><em><p>The number of bytes to receive.</p></em></td></tr><tr><th>$filters</th><td><a href="../files/FilterCollection.html">\PEAR2\Net\Transmitter\FilterCollection</a></td><td><em><p>A collection of filters to apply to the
    stream while receiving. Note that the filters will not be present on
    the stream after receiving is done.</p></em></td></tr><tr><th>$what</th><td>string</td><td><em><p>Descriptive string about what is being
    received (used in exception messages).</p>
</em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>resource</td><td>The received content.</td></tr></table></div><div class="clear"></div></div><a id="\PEAR2\Net\Transmitter\TcpClient::send()" class="anchor"></a><div class="method public"><a href="#" class="gripper"><img src="../images/icons/arrow_right.png"></img><img src="../images/icons/arrow_down.png" style="display: none;"></img></a><code class="title"><img src="../images/icons/method.png" alt="method" title="method"></img><img src="../images/icons/visibility_public.png" style="margin-right: 5px" alt="public"></img><span class="highlight">send</span><span class="nb-faded-text">(string | resource $contents, int $offset = null, int $length = null)</span> : int</code><div class="description"><p class="short_description">Sends a string or stream to the server.</p></div><div class="code-tabs"><div class="long-description">Sends a string or stream to the server. If a seekable stream is
provided, it will be seeked back to the same position it was passed as,
regardless of the $offset parameter.</div><strong>Parameters</strong><table class="argument-info"><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tr><th>$contents</th><td>string | resource</td><td><em><p>The string or stream to send.</p></em></td></tr><tr><th>$offset</th><td>int</td><td><em><p>The offset from which to start sending.
    If a stream is provided, and this is set to NULL, sending will start
    from the current stream position.</p></em></td></tr><tr><th>$length</th><td>int</td><td><em><p>The maximum length to send. If omitted,
    the string/stream will be sent to its end.</p>
</em></td></tr></table><strong>Returns</strong><table class="argument-info"><thead><tr><th>Type</th><th>Description</th></tr></thead><tr><td>int</td><td>The number of bytes sent.</td></tr></table></div><div class="clear"></div></div></div></div></div><small class="footer">
            Documentation was generated by
            <a href="http://phpdoc.org">phpDocumentor
                2.1.0-DEV
</a>.
        </small></body></html>
